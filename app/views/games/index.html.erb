<p id="notice"><%= notice %></p>

<div class='row'>
  <div class='col-md-12 games-index'>
    <h1>Game Marketplace</h1>
  </div>
</div>

<div class='row'>
  <div class='col-md-12 search-bar'>
    <span class='sort-title'>Sort by:</span>
    <span class='sort-filter'><%= sort_link(@q, :title) %></span>
    <span class='search-divider'> | </span>
    <span class='all-games-link'> <%= link_to('View All Games', games_path) %> </span>
    <%= search_form_for @q do |f| %>
    <%= f.search_field :title_cont %>
    <%= f.submit %>
    <% end %>
  </div>
</div>


<table class="table game-listings">
  <thead>
    <!-- Figure out what to do with these? -->
    <tr>
      <th scope="col">Cover</th>
      <th scope="col">Game</th>
      <th scope="col">Decription</th>
      <th scope="col">Price</th>
      <th colspan="3"></th>
    </tr>
  </thead>
  <tbody>
    <% @games.each do |game| %>
      <tr>
        <td class='index-cover'>
          <%= image_tag game.cover.thumb.url%>
        </td>
        <td class='index-title'><%= link_to game.title, game %></td>
        <td><%= game.description %></td>
        <td class='index-price-label'>Price </td>
        <td class='index-price'> <%= game.price %></td>

        <!-- Only show users edit link for their own games -->
        <% if game.user_id == current_user.try(:id) %>
          <td><%=link_to 'Edit', edit_game_path(game) %></td>
          <td><%= link_to 'Destroy', game, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<div class="row">
  <div class="col-md-12 upload-button">
      <% if can? :manage, Game %>
        <%= link_to("<button class='btn btn-secondary btn-lg new-game'>Upload A New Game</button>".html_safe, new_game_path) %>
      <% end %>
  </div>
</div>